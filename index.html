<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>2 player minimalistic chess</title>
    <link rel="stylesheet" type="text/css" href="css/main.css">

    <script>
    function allowDrop(ev) {
	    ev.preventDefault();
    }

    function drag(ev) {
        ev.dataTransfer.setData("text", ev.target.id);
        var draggedObject = ev.dataTransfer.getData("text");
        var draggedObjectById = document.getElementById(draggedObject)

        if (draggedObjectById.id.startsWith("black")) {
            draggedObjectById.style.backgroundColor = "#ff3333";
        } else {
            draggedObjectById.style.backgroundColor = "#3366ff";
        }
    }

    function drop(ev) {
        ev.preventDefault();
        var droppedObject = ev.dataTransfer.getData("text");
        var droppedObjectById = document.getElementById(droppedObject);
        var targetObjectParent = ev.target.parentNode
        var targetObjectParentById = targetObjectParent.id
        var targetObjectParentElements = targetObjectParent.getElementsByTagName('*')

        if (droppedObject.startsWith("black")) {
            var droppedFigureColor = "black";
        } else {
            var droppedFigureColor = "white";
        }

        droppedObjectById.style.backgroundColor = "transparent";

        // if the target is the lost figures section of the board check that color of the lost figure
        // corresponds with the name of the lost figures section
        if (targetObjectParentById.endsWith("lost_figures")) {
            if (targetObjectParentById && targetObjectParentById.startsWith(droppedFigureColor)) {
                ev.target.appendChild(droppedObjectById);
            }
        }
        // if the target is in the game canvas board check that there is no more than 2 figures already
        // and check that if there is already a figure, it's got the opposite color as the dragged figure
          else {
            if (targetObjectParentById && targetObjectParentElements.length < 3) {
                if (targetObjectParentElements[1] != null) {
                    if (targetObjectParentElements[1].id.startsWith(droppedFigureColor) == false) {
                        ev.target.appendChild(droppedObjectById);
                    }
                } else {
                    ev.target.appendChild(droppedObjectById);
                }
            }
        }

    }
    </script>

</head>

<body>

<table id="deck">
    <tr>
        <td colspan="8" id="white_lost_figures">
            <div class="draggable_lost_figures" ondrop="drop(event)" ondragover="allowDrop(event)">lost white figures
            </div>
        </td>
        <td>
            <table id="board" class="chessboard">

                <tr class="chessboard">
                    <td class="chessboard" id="a1">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="white_rook1" draggable="true" ondragstart="drag(event)">&#9814;
                            </div>
                        </div>
                    </td>
                    <td class="chessboard" id="b1">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="white_pawn1" draggable="true" ondragstart="drag(event)">&#9817;
                            </div>
                        </div>
                    </td>
                    <td class="chessboard" id="c1">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="d1">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="e1">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="f1">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="g1">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="black_pawn1" draggable="true" ondragstart="drag(event)">&#9823;
                            </div>
                        </div>
                    </td>
                    <td class="chessboard" id="h1">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="black_rook1" draggable="true" ondragstart="drag(event)">&#9820;
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="chessboard">
                    <td class="chessboard" id="a2">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="white_knight1" draggable="true" ondragstart="drag(event)">&#9816;
                            </div>
                        </div>
                    </td>
                    <td class="chessboard" id="b2">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="white_pawn2" draggable="true" ondragstart="drag(event)">&#9817;
                            </div>
                        </div>
                    </td>
                    <td class="chessboard" id="c2">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="d2">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="e2">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="f2">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="g2">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="black_pawn2" draggable="true" ondragstart="drag(event)">&#9823;
                            </div>
                        </div>
                    </td>
                    <td class="chessboard" id="h2">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="black_knight1" draggable="true" ondragstart="drag(event)">&#9822;
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="chessboard">
                    <td class="chessboard" id="a3">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="white_bishop1" draggable="true" ondragstart="drag(event)">&#9815;
                            </div>
                        </div>
                    </td>
                    <td class="chessboard" id="b3">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="white_pawn3" draggable="true" ondragstart="drag(event)">&#9817;
                            </div>
                        </div>
                    </td>
                    <td class="chessboard" id="c3">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="d3">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="e3">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="f3">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="g3">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="black_pawn3" draggable="true" ondragstart="drag(event)">&#9823;
                            </div>
                        </div>
                    </td>
                    <td class="chessboard" id="h3">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="black_bishop1" draggable="true" ondragstart="drag(event)">&#9821;
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="chessboard">
                    <td class="chessboard" id="a4">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="white_queen" draggable="true" ondragstart="drag(event)">&#9813;
                            </div>
                        </div>
                    </td>
                    <td class="chessboard" id="b4">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="white_pawn4" draggable="true" ondragstart="drag(event)">&#9817;
                            </div>
                        </div>
                    </td>
                    <td class="chessboard" id="c4">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="d4">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="e4">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="f4">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="g4">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="black_pawn4" draggable="true" ondragstart="drag(event)">&#9823;
                            </div>
                        </div>
                    </td>
                    <td class="chessboard" id="h4">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="black_queen" draggable="true" ondragstart="drag(event)">&#9819;
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="chessboard">
                    <td class="chessboard" id="a5">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="white_king" draggable="true" ondragstart="drag(event)">&#9812;</div>
                        </div>
                    </td>
                    <td class="chessboard" id="b5">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="white_pawn5" draggable="true" ondragstart="drag(event)">&#9817;
                            </div>
                        </div>
                    </td>
                    <td class="chessboard" id="c5">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="d5">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="e5">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="f5">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="g5">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="black_pawn5" draggable="true" ondragstart="drag(event)">&#9823;
                            </div>
                        </div>
                    </td>
                    <td class="chessboard" id="h5">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="black_king" draggable="true" ondragstart="drag(event)">&#9818;</div>
                        </div>
                    </td>
                </tr>
                <tr class="chessboard">
                    <td class="chessboard" id="a6">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="white_pawn6" draggable="true" ondragstart="drag(event)">&#9815;
                            </div>
                        </div>
                    </td>
                    <td class="chessboard" id="b6">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="white_bishop2" draggable="true" ondragstart="drag(event)">&#9817;
                            </div>
                        </div>
                    </td>
                    <td class="chessboard" id="c6">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="d6">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="e6">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="f6">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="g6">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="black_pawn6" draggable="true" ondragstart="drag(event)">&#9823;
                            </div>
                        </div>
                    </td>
                    <td class="chessboard" id="h6">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="black_bishop2" draggable="true" ondragstart="drag(event)">&#9821;
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="chessboard">
                    <td class="chessboard" id="a7">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="white_pawn7" draggable="true" ondragstart="drag(event)">&#9816;
                            </div>
                        </div>
                    </td>
                    <td class="chessboard" id="b7">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="white_knight2" draggable="true" ondragstart="drag(event)">&#9817;
                            </div>
                        </div>
                    </td>
                    <td class="chessboard" id="c7">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="d7">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="e7">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="f7">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="g7">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="black_knight2" draggable="true" ondragstart="drag(event)">&#9823;
                            </div>
                        </div>
                    </td>
                    <td class="chessboard" id="h7">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="black_pawn7" draggable="true" ondragstart="drag(event)">&#9822;
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="chessboard">
                    <td class="chessboard" id="a8">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="white_pawn8" draggable="true" ondragstart="drag(event)">&#9814;
                            </div>
                        </div>
                    </td>
                    <td class="chessboard" id="b8">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="white_rook2" draggable="true" ondragstart="drag(event)">&#9817;
                            </div>
                        </div>
                    </td>
                    <td class="chessboard" id="c8">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="d8">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="e8">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="f8">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    </td>
                    <td class="chessboard" id="g8">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="black_rook2" draggable="true" ondragstart="drag(event)">&#9823;
                            </div>
                        </div>
                    </td>
                    <td class="chessboard" id="h8">
                        <div class="draggable" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="figure" id="black_pawn8" draggable="true" ondragstart="drag(event)">&#9820;
                            </div>
                        </div>
                    </td>
                </tr>

            </table>

        </td>
        <td id="black_lost_figures">
            <div class="draggable_lost_figures" ondrop="drop(event)" ondragover="allowDrop(event)">lost black figures
            </div>
        </td>
    </tr>
</table>

</body>

</html>
